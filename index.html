<!DOCTYPE html>
<html lang="es" class="scroll-smooth">
<head>
    <meta charset="utf-8"/>
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" name="viewport"/>
    <title>Socios CBO - Zona Mayorista</title>
    
    <!-- Fuentes (Inter simula San Francisco de Apple) -->
    <link href="https://fonts.googleapis.com" rel="preconnect"/>
    <link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet"/>
    <!-- Iconos -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- LIBRERÃAS (VÃ­a CDN) -->
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.3/dist/confetti.browser.min.js"></script>

    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              iosBg: "#F2F2F7", /* Fondo gris base de iOS */
              iosCard: "#FFFFFF",
              iosBlue: "#007AFF",
              iosGreen: "#34C759",
              iosOrange: "#FF9500",
              iosRed: "#FF3B30",
              textMain: "#1C1C1E",
              textLight: "#8E8E93",
            },
            fontFamily: {
              sans: ["Inter", "-apple-system", "system-ui", "sans-serif"],
            },
            boxShadow: {
                'ios': '0 4px 20px rgba(0,0,0,0.05)',
                'ios-float': '0 10px 40px rgba(0,0,0,0.12)',
                'ios-modal': '0 -10px 40px rgba(0,0,0,0.15)'
            },
            transitionTimingFunction: {
                'apple': 'cubic-bezier(0.32, 0.72, 0, 1)',
                'spring': 'cubic-bezier(0.175, 0.885, 0.32, 1.275)'
            }
          },
        },
      };
    </script>

    <style>
        body { background-color: #F2F2F7; color: #1C1C1E; -webkit-font-smoothing: antialiased; overflow-x: hidden; padding-bottom: calc(100px + env(safe-area-inset-bottom)); }
        
        /* Ocultar scrollbars para look mÃ¡s limpio */
        .hide-scrollbar::-webkit-scrollbar { display: none; }
        .hide-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        .snap-x-mandatory { scroll-snap-type: x mandatory; }
        .snap-center { scroll-snap-align: center; }

        /* Efecto Glass de Apple */
        .apple-glass { background: rgba(255, 255, 255, 0.75); backdrop-filter: blur(24px); -webkit-backdrop-filter: blur(24px); border-bottom: 0.5px solid rgba(0,0,0,0.1); }
        .apple-glass-dark { background: rgba(28, 28, 30, 0.8); backdrop-filter: blur(24px); -webkit-backdrop-filter: blur(24px); border-top: 0.5px solid rgba(255,255,255,0.1); }

        /* Animaciones Pop (Rebote) */
        .pop-anim { animation: pop 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
        @keyframes pop { 0% { transform: scale(1); } 50% { transform: scale(1.15); } 100% { transform: scale(1); } }
        
        .pulse-light { animation: pulseL 2s infinite; }
        @keyframes pulseL { 0%, 100% { opacity: 1; transform: scale(1); } 50% { opacity: 0.8; transform: scale(0.95); } }

        /* No select */
        .no-select { user-select: none; -webkit-touch-callout: none; }
        .progress-bar-fill { transition: width 0.6s cubic-bezier(0.32, 0.72, 0, 1); }
    </style>
</head>
<body class="font-sans antialiased relative"> 

    <!-- NAV ESTILO APPLE (Glassmorphism & Search) -->
    <nav class="fixed top-0 w-full z-50 apple-glass pt-[env(safe-area-inset-top)] pb-3">
        <div class="flex items-center justify-between px-4 md:px-6 pt-2 mb-3">
            <span class="font-bold text-xl tracking-tight text-textMain">MiniPerfumes<span class="text-iosOrange">CBO</span></span>
            <div class="flex items-center gap-3">
                <a href="https://wa.me/584141087079?text=Hola%20equipo%20CBO!%20Necesito%20asesorÃ­a." target="_blank" class="w-9 h-9 bg-gray-100 rounded-full flex items-center justify-center text-iosBlue hover:bg-blue-50 transition active:scale-95">
                    <i class="fab fa-whatsapp text-lg"></i>
                </a>
            </div>
        </div>
        <!-- Buscador estilo Spotlight -->
        <div class="px-4 md:px-6 max-w-4xl mx-auto">
            <div class="relative w-full bg-[#e3e3e8] rounded-xl flex items-center overflow-hidden transition-all focus-within:ring-2 ring-iosBlue/50">
                <i class="fas fa-search text-gray-500 pl-3.5 text-sm"></i>
                <input type="text" id="searchInput" onkeyup="filterCatalog()" class="w-full pl-2 pr-4 py-2 bg-transparent text-[15px] border-none focus:ring-0 outline-none placeholder-gray-500 text-textMain" placeholder="Buscar perfumes, marcas...">
            </div>
        </div>
    </nav>

    <!-- BANNER HERO (Estilo App Store Card) -->
    <header class="pt-32 pb-4 px-4 md:px-6 max-w-4xl mx-auto" data-aos="fade-up" data-aos-duration="800">
        <div class="w-full bg-textMain rounded-[2rem] p-6 md:p-10 relative overflow-hidden shadow-ios-float text-white">
            <div class="absolute -right-10 -top-10 w-40 h-40 bg-iosOrange opacity-20 rounded-full blur-3xl"></div>
            <div class="absolute -left-10 -bottom-10 w-40 h-40 bg-iosBlue opacity-20 rounded-full blur-3xl"></div>
            
            <p class="text-[11px] md:text-xs font-bold text-gray-400 tracking-widest mb-1 uppercase">ImportaciÃ³n RÃ¡pida</p>
            <h2 class="text-3xl md:text-5xl font-black leading-tight tracking-tight mb-4">
                El surtido perfecto,<br>a un toque.
            </h2>
            
            <div class="flex gap-3">
                <button onclick="openFAQ()" class="bg-white/10 backdrop-blur-md text-white border border-white/20 text-xs font-semibold px-4 py-2 rounded-full hover:bg-white/20 transition active:scale-95 flex items-center gap-2">
                    <i class="fas fa-robot"></i> Dudas
                </button>
                <button onclick="startTour()" class="bg-iosBlue text-white text-xs font-semibold px-4 py-2 rounded-full hover:bg-blue-600 transition active:scale-95 flex items-center gap-2">
                    <i class="fas fa-magic"></i> Tour
                </button>
            </div>
        </div>
    </header>

    <!-- COMBOS (Estilo Horizontal Scroll iOS) -->
    <div class="w-full relative z-20 mb-8" data-aos="fade-up" data-aos-delay="100">
        <div class="px-4 md:px-6 mb-3 flex items-center justify-between max-w-4xl mx-auto">
            <h3 class="text-lg font-bold tracking-tight text-textMain">Cajas Inteligentes</h3>
            <span class="text-xs font-medium text-textLight">1-Click</span>
        </div>
        
        <div class="max-w-6xl mx-auto px-4 md:px-6">
            <div class="flex overflow-x-auto hide-scrollbar snap-x snap-mandatory gap-4 pb-2">
                
                <!-- Combo 20 -->
                <div onclick="addComboToCart(20, 'Emprendedor')" class="snap-start shrink-0 w-[140px] bg-iosCard rounded-3xl shadow-ios p-5 flex flex-col items-center justify-center text-center cursor-pointer hover:shadow-lg transition-all active:scale-95 group">
                    <div class="h-14 w-14 flex items-center justify-center bg-[#F2F2F7] rounded-full mb-3 text-2xl text-textMain group-hover:bg-textMain group-hover:text-white transition-colors"><i class="fas fa-box"></i></div>
                    <h3 class="font-bold text-sm text-textMain tracking-tight">Caja x20</h3>
                    <p class="text-xs text-textLight mt-1 font-medium">$6.00 c/u</p>
                </div>

                <!-- Combo 50 -->
                <div onclick="addComboToCart(50, 'Negocio')" class="snap-start shrink-0 w-[140px] bg-iosOrange rounded-3xl shadow-ios-float p-5 flex flex-col items-center justify-center text-center cursor-pointer transition-all active:scale-95 relative group">
                    <div class="absolute -top-2 bg-textMain text-white text-[10px] font-bold px-3 py-1 rounded-full shadow-sm">Popular</div>
                    <div class="h-14 w-14 flex items-center justify-center bg-white/20 rounded-full mb-3 text-2xl text-white"><i class="fas fa-box-open"></i></div>
                    <h3 class="font-bold text-sm text-white tracking-tight">Caja x50</h3>
                    <p class="text-xs text-white/80 mt-1 font-medium">$4.50 c/u</p>
                </div>

                <!-- Combo 100 -->
                <div onclick="addComboToCart(100, 'Mayorista')" class="snap-start shrink-0 w-[140px] bg-iosCard rounded-3xl shadow-ios p-5 flex flex-col items-center justify-center text-center cursor-pointer hover:shadow-lg transition-all active:scale-95 group">
                    <div class="h-14 w-14 flex items-center justify-center bg-[#F2F2F7] rounded-full mb-3 text-2xl text-textMain group-hover:bg-textMain group-hover:text-white transition-colors"><i class="fas fa-boxes"></i></div>
                    <h3 class="font-bold text-sm text-textMain tracking-tight">Caja x100</h3>
                    <p class="text-xs text-textLight mt-1 font-medium">$3.50 c/u</p>
                </div>

            </div>
        </div>
    </div>

    <!-- TOP 5 TENDENCIAS -->
    <section class="mb-8 hidden" id="top5-section" data-aos="fade-up">
        <div class="px-4 md:px-6 mb-3 flex items-center justify-between max-w-4xl mx-auto">
            <h3 class="text-lg font-bold tracking-tight text-textMain">Tendencias Hoy</h3>
        </div>
        <div class="max-w-6xl mx-auto px-4 md:px-6">
            <div id="top5-container" class="flex gap-4 overflow-x-auto pb-4 hide-scrollbar snap-x-mandatory">
                <!-- Inyectado por JS -->
            </div>
        </div>
    </section>

    <!-- INDICADORES -->
    <div id="loading-indicator" class="text-center py-16 text-sm text-textLight font-medium flex flex-col items-center justify-center">
        <i class="fas fa-circle-notch fa-spin text-3xl mb-4 text-iosBlue"></i>
        Sincronizando catÃ¡logo...
    </div>
    <div id="error-indicator" class="hidden text-center py-6 text-sm font-bold bg-red-100 text-iosRed rounded-3xl p-6 mx-4 mb-6 shadow-sm">
        <i class="fas fa-exclamation-circle text-2xl mb-2"></i> 
        <p id="error-text" class="mt-2 text-xs opacity-80"></p>
    </div>

    <!-- CATÃLOGO -->
    <section id="catalog-zone" class="hidden pb-10">
        <div class="container mx-auto px-4 max-w-4xl">
            <!-- Filtros PÃ­ldora iOS -->
            <div class="mb-6 sticky top-[90px] z-40 bg-[#F2F2F7]/90 backdrop-blur-md py-3 -mx-4 px-4 border-b border-gray-200/50">
                <div class="flex items-center gap-2 overflow-x-auto hide-scrollbar" id="brand-filters-container">
                    <!-- Botones inyectados por JS -->
                </div>
            </div>

            <div id="catalog-container" class="space-y-8">
                <!-- Productos inyectados por JS -->
            </div>
        </div>
    </section>

    <!-- STICKY CART (PÃ­ldora Flotante Apple) -->
    <div class="fixed bottom-6 left-4 right-4 md:left-auto md:right-6 md:w-80 z-[80] apple-glass-dark rounded-[2rem] p-2 flex items-center justify-between transition-all transform translate-y-32 duration-500 ease-apple shadow-ios-modal border border-white/10" id="sticky-cart">
        <div class="flex items-center gap-3 pl-3" id="tour-step-3">
            <div class="w-10 h-10 bg-white/20 rounded-full flex items-center justify-center text-white relative">
                <i class="fas fa-shopping-bag"></i>
                <span id="sticky-qty" class="absolute -top-1 -right-1 bg-iosRed text-white text-[10px] font-bold w-5 h-5 flex items-center justify-center rounded-full border-2 border-[#1C1C1E] transition-transform duration-300">0</span>
            </div>
            <div class="flex flex-col">
                <span class="text-[10px] text-gray-300 font-medium tracking-wide">Total</span>
                <span id="sticky-total" class="text-base font-bold text-white tracking-tight">$0.00</span>
            </div>
        </div>
        
        <button onclick="openCartModal()" class="bg-white text-textMain px-6 py-3 rounded-full text-sm font-bold hover:bg-gray-100 active:scale-95 transition-all">
            Ver Pedido
        </button>
    </div>

    <!-- MODAL DE CARRITO (Bottom Sheet iOS) -->
    <div id="cart-modal" class="fixed inset-0 z-[100] hidden">
        <!-- Backdrop -->
        <div class="absolute inset-0 bg-black/30 backdrop-blur-[4px] opacity-0 transition-opacity duration-500 ease-apple" id="cart-backdrop" onclick="closeCartModal()"></div>
        
        <!-- Sheet Content -->
        <div id="cart-sheet" class="absolute bottom-0 left-0 w-full md:w-[450px] md:left-1/2 md:-translate-x-1/2 h-[85vh] bg-[#F2F2F7] rounded-t-[32px] transform translate-y-full transition-transform duration-500 ease-apple flex flex-col overflow-hidden shadow-2xl">
            
            <!-- Handle iOS -->
            <div class="w-full flex justify-center pt-3 pb-2 bg-iosCard rounded-t-[32px] cursor-grab active:cursor-grabbing" onclick="closeCartModal()">
                <div class="w-12 h-1.5 bg-gray-300 rounded-full"></div>
            </div>

            <!-- Cabecera -->
            <div class="px-6 py-3 bg-iosCard flex justify-between items-center border-b border-gray-100">
                <h2 class="text-2xl font-bold tracking-tight text-textMain">Tu Pedido</h2>
                <button onclick="clearCart()" class="text-iosRed bg-red-50 px-3 py-1.5 rounded-full text-xs font-bold active:scale-95 transition-transform">
                    Vaciar
                </button>
            </div>

            <!-- Barra de Progreso -->
            <div class="bg-iosCard px-6 py-4 shadow-sm mb-2">
                <div class="flex justify-between items-end mb-2">
                    <span class="text-xs font-semibold text-textLight" id="progress-title">Nivel Actual</span>
                    <span class="text-sm font-bold text-textMain" id="progress-price">$6.00 c/u</span>
                </div>
                <div class="w-full bg-[#E5E5EA] rounded-full h-2 mb-2 overflow-hidden">
                    <div class="bg-iosBlue h-full rounded-full progress-bar-fill" id="progress-bar" style="width: 0%"></div>
                </div>
                <p class="text-[11px] text-textLight font-medium" id="progress-msg">Agrega 20 uds para tu primer descuento.</p>
            </div>
            
            <!-- Items -->
            <div class="flex-1 overflow-y-auto px-4 py-2" id="cart-items-container">
                <!-- JS Inyecta -->
            </div>

            <!-- Sugerencias -->
            <div id="cart-suggestions-container" class="px-4 pb-2 hidden">
                <h3 class="text-[11px] font-bold text-textLight uppercase tracking-wider mb-2 pl-2">Sugerencias</h3>
                <div class="flex gap-3 overflow-x-auto hide-scrollbar pb-2 snap-x-mandatory" id="cart-suggestions-list">
                    <!-- JS Inyecta -->
                </div>
            </div>

            <!-- Resumen y Pago (Bottom) -->
            <div class="p-6 bg-iosCard rounded-t-[2rem] shadow-[0_-10px_30px_rgba(0,0,0,0.06)] pb-[calc(1.5rem+env(safe-area-inset-bottom))]">
                
                <!-- Toggle MÃ©todo Pago iOS Style -->
                <div class="bg-[#E5E5EA] p-1 rounded-xl flex mb-5 relative">
                    <label class="flex-1 text-center py-2 text-xs font-bold rounded-lg cursor-pointer transition-all z-10 [&:has(input:checked)]:text-textMain [&:has(input:checked)]:shadow-sm [&:has(input:checked)]:bg-white text-textLight" onclick="setPaymentMethod('bs')">
                        <input type="radio" name="payment" value="bs" class="hidden" id="radio-bs" checked>
                        Bs / Pago MÃ³vil
                    </label>
                    <label class="flex-1 text-center py-2 text-xs font-bold rounded-lg cursor-pointer transition-all z-10 [&:has(input:checked)]:text-textMain [&:has(input:checked)]:shadow-sm [&:has(input:checked)]:bg-white text-textLight flex justify-center items-center gap-1" onclick="setPaymentMethod('zelle')">
                        <input type="radio" name="payment" value="zelle" class="hidden" id="radio-zelle">
                        Zelle <span class="bg-iosGreen text-white text-[8px] px-1.5 py-0.5 rounded">-5%</span>
                    </label>
                </div>
                
                <div class="space-y-2 mb-5">
                    <div class="flex justify-between text-sm text-textLight font-medium">
                        <span>Subtotal (<span id="cart-modal-qty">0</span>)</span>
                        <span id="cart-modal-subtotal">$0.00</span>
                    </div>
                    <div id="cart-discount-row" class="flex justify-between text-sm text-iosGreen font-medium hidden">
                        <span>Descuento</span>
                        <span id="cart-modal-discount">-$0.00</span>
                    </div>
                    <div class="flex justify-between items-center pt-2 border-t border-gray-100">
                        <span class="font-bold text-textMain">Total</span>
                        <span id="cart-modal-total" class="text-2xl font-black text-textMain tracking-tight">$0.00</span>
                    </div>
                </div>

                <button id="cart-modal-btn" onclick="sendWhatsAppOrder()" class="w-full bg-iosBlue text-white font-bold py-4 rounded-2xl transition-all active:scale-95 disabled:opacity-50 disabled:bg-gray-300 text-[15px] shadow-ios flex justify-center items-center gap-2">
                    Confirmar Pedido
                </button>
            </div>
        </div>
    </div>

    <!-- MODAL FAQ / CHATBOT (Bottom Sheet iOS) -->
    <div id="faq-modal" class="fixed inset-0 z-[120] hidden">
        <div class="absolute inset-0 bg-black/30 backdrop-blur-[4px] opacity-0 transition-opacity duration-500 ease-apple" id="faq-backdrop" onclick="closeFAQ()"></div>
        <div id="faq-sheet" class="absolute bottom-0 left-0 w-full md:w-[400px] md:left-1/2 md:-translate-x-1/2 h-[75vh] bg-[#F2F2F7] rounded-t-[32px] transform translate-y-full transition-transform duration-500 ease-apple flex flex-col overflow-hidden shadow-2xl">
            <div class="w-full flex justify-center pt-3 pb-2 bg-iosCard rounded-t-[32px]" onclick="closeFAQ()"><div class="w-12 h-1.5 bg-gray-300 rounded-full"></div></div>
            <div class="px-6 py-3 bg-iosCard border-b border-gray-100 flex justify-between items-center">
                <h2 class="text-xl font-bold text-textMain">Asistente</h2>
                <button onclick="closeFAQ()" class="bg-gray-100 w-8 h-8 rounded-full text-textLight text-xs"><i class="fas fa-times"></i></button>
            </div>
            <div class="p-5 overflow-y-auto space-y-3 bg-[#F2F2F7] flex-1 hide-scrollbar">
                <div class="bg-iosCard p-4 rounded-2xl shadow-sm">
                    <p class="font-semibold text-sm text-textMain mb-1">Â¿CÃ³mo elijo?</p>
                    <p class="text-xs text-textLight leading-relaxed">Usa las cajas inteligentes (Combos) para un surtido rÃ¡pido, o aÃ±ade aromas manualmente abajo.</p>
                </div>
                <div class="bg-iosCard p-4 rounded-2xl shadow-sm">
                    <p class="font-semibold text-sm text-textMain mb-1">Â¿Pagos?</p>
                    <p class="text-xs text-textLight leading-relaxed">Aceptamos Pago MÃ³vil, Efectivo, y Zelle/USDT <strong class="text-iosGreen">(Con 5% de descuento)</strong>.</p>
                </div>
                <div class="bg-iosCard p-4 rounded-2xl shadow-sm">
                    <p class="font-semibold text-sm text-textMain mb-1">Â¿MÃ­nimo?</p>
                    <p class="text-xs text-textLight leading-relaxed">Para precios mayoristas, necesitas <strong>20 unidades</strong>.</p>
                </div>
                <div class="mt-6 text-center">
                    <a href="https://wa.me/584141087079?text=Hola%20equipo%20CBO!%20Necesito%20hablar%20con%20un%20asesor." target="_blank" class="inline-flex items-center gap-2 bg-textMain text-white font-semibold px-6 py-3 rounded-full text-sm shadow-ios active:scale-95 transition-transform">
                        Hablar con Asesor Humano
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- MODAL VISTA PREVIA IMAGEN -->
    <div id="image-preview-modal" class="fixed inset-0 bg-black/90 backdrop-blur-md z-[130] hidden flex flex-col items-center justify-center p-4 transition-opacity opacity-0 duration-400 ease-apple" onclick="hidePreview()">
        <button class="absolute top-safe right-6 bg-white/20 w-8 h-8 rounded-full text-white mt-4"><i class="fas fa-times"></i></button>
        <img id="preview-img-element" src="" class="max-w-full max-h-[70vh] object-contain rounded-3xl transform scale-90 transition-transform duration-500 ease-apple">
    </div>

    <!-- ASISTENTE NAVI (MODO TOUR) -->
    <div id="tour-navi" class="fixed z-[140] flex flex-col items-center pointer-events-none hidden transition-all duration-700 ease-apple" style="top: 50%; left: 50%; transform: translate(-50%, -50%);">
        <div id="tour-speech" class="bg-textMain text-white text-sm font-semibold px-5 py-3 rounded-2xl shadow-ios-modal mb-3 speech-bubble text-center max-w-[250px]">
            Â¡Hola! Soy Navi.
        </div>
        <div class="navi-orb w-14 h-14 rounded-full shadow-navi border-2 border-white"></div>
    </div>

    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <script>
        AOS.init({ duration: 600, once: true, offset: 30, easing: 'ease-out-cubic' });

        const API_URL = "https://script.google.com/macros/s/AKfycbzEvk_VbWIFs4sChKj9IAQcwbS-q1BdyfUM27zDiIEZ_d8Yw40bfyo4CkA8T7bfArl8lQ/exec";
        
        let catalogData = [];
        let flatProducts = []; 
        let cart = {}; 
        let paymentMethod = 'bs';
        const PRICES = { base: 6.00, mid: 4.50, top: 3.50 };

        // --- Utilidad Haptic (Iphonization) ---
        function haptic(type = 'light') {
            if (!navigator.vibrate) return;
            if (type === 'light') navigator.vibrate(10);
            if (type === 'success') navigator.vibrate([20, 30, 20]);
            if (type === 'heavy') navigator.vibrate(40);
        }

        // --- Utilidad NotificaciÃ³n Estilo Dynamic Island ---
        function showIOSNotification(text, type = 'success') {
            const bg = type === 'error' ? 'rgba(255, 59, 48, 0.9)' : 'rgba(28, 28, 30, 0.85)';
            Toastify({
                text: text,
                duration: 2500,
                gravity: "top",
                position: "center",
                style: {
                    background: bg,
                    backdropFilter: "blur(12px)",
                    WebkitBackdropFilter: "blur(12px)",
                    borderRadius: "100px",
                    padding: "12px 24px",
                    fontSize: "13px",
                    fontWeight: "600",
                    boxShadow: "0 10px 40px rgba(0,0,0,0.15)",
                    color: "#fff"
                }
            }).showToast();
        }

        async function loadCatalog() {
            try {
                const response = await fetch(API_URL, { redirect: "follow" });
                const rawText = await response.text();
                let data;
                try { data = JSON.parse(rawText); } catch (e) { throw new Error("Google bloqueÃ³ la solicitud."); }
                if (data.error) throw new Error("Fallo en Drive: " + data.error);

                catalogData = processJsonData(data);
                
                document.getElementById('loading-indicator').classList.add('hidden');
                document.getElementById('catalog-zone').classList.remove('hidden');
                
                generateTop5();
                renderBrandFilters();
                renderCatalog();
            } catch (error) {
                document.getElementById('loading-indicator').classList.add('hidden');
                document.getElementById('error-indicator').classList.remove('hidden');
                document.getElementById('error-text').innerText = error.message;
            }
        }

        function processJsonData(data) {
            let processed = {};
            flatProducts = []; 
            data.forEach(item => {
                let brand = item.brand || "Otras Marcas";
                if(!processed[brand]) processed[brand] = [];
                let finalImg = item.img;
                if (!finalImg || finalImg.includes('unsplash.com')) {
                    finalImg = "https://placehold.co/400x400/F2F2F7/8E8E93?text=Sin+Foto"; 
                }
                const prodObj = { id: item.sku, name: item.name, cap: item.cap, img: finalImg, brand: brand };
                processed[brand].push(prodObj);
                flatProducts.push(prodObj); 
            });
            let finalArray = [];
            for (let brand in processed) { 
                if (processed[brand].length > 0) finalArray.push({ brand: brand, products: processed[brand] }); 
            }
            return finalArray;
        }

        function generateTop5() {
            const container = document.getElementById('top5-container');
            const section = document.getElementById('top5-section');
            if (!container || flatProducts.length < 5) return; 

            let shuffled = [...flatProducts].sort(() => 0.5 - Math.random());
            let top5 = shuffled.slice(0, 5);
            let html = '';
            top5.forEach((prod) => {
                html += `
                <div class="min-w-[130px] bg-iosCard p-3 rounded-3xl shadow-ios snap-center flex flex-col relative group">
                    <div class="w-full aspect-square relative mb-2 cursor-pointer" onclick="showPreview('${prod.img}')">
                        <img src="${prod.img}" class="w-full h-full object-cover rounded-2xl bg-[#F2F2F7]">
                    </div>
                    <p class="font-semibold text-xs text-textMain leading-tight line-clamp-2 w-full mb-2 h-[32px]">${prod.name}</p>
                    <div class="mt-auto w-full">
                        <button onclick="updateCart('${prod.id}', 1)" class="w-full bg-[#F2F2F7] text-iosBlue hover:bg-iosBlue hover:text-white font-bold py-2 rounded-xl transition-colors text-xs active:scale-95">
                            Agregar
                        </button>
                    </div>
                </div>`;
            });
            container.innerHTML = html;
            section.classList.remove('hidden');
        }

        // --- Modales Apple Style ---
        function openCartModal() {
            haptic('light');
            const modal = document.getElementById('cart-modal');
            const backdrop = document.getElementById('cart-backdrop');
            const sheet = document.getElementById('cart-sheet');
            
            modal.classList.remove('hidden');
            void modal.offsetWidth; // Force reflow
            
            backdrop.classList.remove('opacity-0');
            sheet.classList.remove('translate-y-full');
            document.body.style.overflow = 'hidden';
            renderCartModalItems();
        }

        function closeCartModal() {
            const backdrop = document.getElementById('cart-backdrop');
            const sheet = document.getElementById('cart-sheet');
            
            backdrop.classList.add('opacity-0');
            sheet.classList.add('translate-y-full');
            
            setTimeout(() => {
                document.getElementById('cart-modal').classList.add('hidden');
                document.body.style.overflow = '';
            }, 500);
        }

        function openFAQ() {
            haptic('light');
            const modal = document.getElementById('faq-modal');
            const backdrop = document.getElementById('faq-backdrop');
            const sheet = document.getElementById('faq-sheet');
            modal.classList.remove('hidden');
            void modal.offsetWidth;
            backdrop.classList.remove('opacity-0');
            sheet.classList.remove('translate-y-full');
            document.body.style.overflow = 'hidden'; 
        }

        function closeFAQ() {
            const backdrop = document.getElementById('faq-backdrop');
            const sheet = document.getElementById('faq-sheet');
            backdrop.classList.add('opacity-0');
            sheet.classList.add('translate-y-full');
            setTimeout(() => {
                document.getElementById('faq-modal').classList.add('hidden');
                document.body.style.overflow = '';
            }, 500);
        }

        function showPreview(imgSrc) {
            haptic('light');
            const modal = document.getElementById('image-preview-modal');
            const imgEl = document.getElementById('preview-img-element');
            imgEl.src = imgSrc;
            modal.classList.remove('hidden');
            void modal.offsetWidth;
            modal.classList.remove('opacity-0');
            imgEl.classList.remove('scale-90');
            imgEl.classList.add('scale-100');
        }

        function hidePreview() {
            const modal = document.getElementById('image-preview-modal');
            const imgEl = document.getElementById('preview-img-element');
            modal.classList.add('opacity-0');
            imgEl.classList.remove('scale-100');
            imgEl.classList.add('scale-90');
            setTimeout(() => modal.classList.add('hidden'), 400);
        }

        // --- CatÃ¡logo y Filtros ---
        function renderBrandFilters() {
            const container = document.getElementById('brand-filters-container');
            if(!container) return;
            let html = `<button onclick="filterByBrand('All')" class="brand-filter-btn active whitespace-nowrap px-4 py-1.5 rounded-full text-[13px] font-semibold bg-textMain text-white transition-colors">Todos</button>`;
            catalogData.forEach(cat => {
                html += `<button onclick="filterByBrand('${cat.brand}')" class="brand-filter-btn whitespace-nowrap px-4 py-1.5 rounded-full text-[13px] font-semibold bg-white text-textLight border border-gray-200 hover:text-textMain transition-colors">${cat.brand}</button>`;
            });
            container.innerHTML = html;
        }

        function filterByBrand(brandName) {
            haptic('light');
            document.querySelectorAll('.brand-filter-btn').forEach(btn => {
                if (btn.innerText === brandName || (brandName === 'All' && btn.innerText === 'Todos')) {
                    btn.className = "brand-filter-btn active whitespace-nowrap px-4 py-1.5 rounded-full text-[13px] font-semibold bg-textMain text-white transition-colors";
                } else {
                    btn.className = "brand-filter-btn whitespace-nowrap px-4 py-1.5 rounded-full text-[13px] font-semibold bg-white text-textLight border border-gray-200 hover:text-textMain transition-colors";
                }
            });
            document.querySelectorAll('.category-block').forEach(catBlock => {
                catBlock.style.display = (brandName === 'All' || catBlock.getAttribute('data-brand') === brandName) ? "block" : "none";
            });
            window.scrollTo({top: document.getElementById('catalog-zone').offsetTop - 100, behavior: 'smooth'});
        }

        function filterCatalog() {
            let input = document.getElementById('searchInput').value.toLowerCase();
            document.querySelectorAll('.category-block').forEach(cat => {
                let cards = cat.querySelectorAll('.product-card');
                let hasVisible = false;
                cards.forEach(card => {
                    if (card.getAttribute('data-search').indexOf(input) > -1) { card.style.display = "flex"; hasVisible = true; } 
                    else card.style.display = "none";
                });
                cat.style.display = hasVisible ? "block" : "none";
            });
        }

        function renderCatalog() {
            const container = document.getElementById('catalog-container');
            if(!container) return;
            let html = '';
            catalogData.forEach((category) => {
                html += `
                <div class="category-block mb-10" data-brand="${category.brand}">
                    <h3 class="text-xl font-bold tracking-tight mb-4 text-textMain pl-2">${category.brand}</h3>
                    <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3 md:gap-5">`;
                category.products.forEach((prod) => {
                    let searchTerms = `${category.brand} ${prod.name} ${prod.id}`.toLowerCase();
                    html += `
                    <div class="product-card flex flex-col items-center bg-iosCard p-3 rounded-3xl shadow-ios transition-all relative group" data-search="${searchTerms}">
                        <div class="w-full aspect-square relative mb-2 cursor-pointer" onclick="showPreview('${prod.img}')">
                            <img src="${prod.img}" class="w-full h-full object-cover rounded-2xl bg-[#F2F2F7]">
                        </div>
                        <div class="flex-1 w-full flex flex-col px-1">
                            <p class="font-semibold text-[13px] md:text-sm text-textMain leading-tight mb-1 line-clamp-2 min-h-[36px]">${prod.name}</p>
                            <p class="text-[10px] font-medium text-textLight mb-3">${prod.cap}</p>
                            <div class="mt-auto w-full">
                                <button id="add-btn-${prod.id}" onclick="updateCart('${prod.id}', 1)" class="w-full bg-[#F2F2F7] text-iosBlue hover:bg-iosBlue hover:text-white font-bold py-2 rounded-xl transition-colors text-xs active:scale-95">
                                    Agregar
                                </button>
                                <!-- Stepper iOS Style -->
                                <div id="ctrls-${prod.id}" class="hidden flex items-center justify-between bg-[#F2F2F7] rounded-xl p-1 w-full">
                                    <button onclick="updateCart('${prod.id}', -1)" class="w-8 h-8 flex items-center justify-center text-textMain bg-white rounded-lg shadow-sm active:scale-95"><i class="fas fa-minus text-[10px]"></i></button>
                                    <span id="qty-${prod.id}" class="text-sm font-bold w-6 text-center text-textMain">0</span>
                                    <button onclick="updateCart('${prod.id}', 1)" class="w-8 h-8 flex items-center justify-center text-textMain bg-white rounded-lg shadow-sm active:scale-95"><i class="fas fa-plus text-[10px]"></i></button>
                                </div>
                            </div>
                        </div>
                    </div>`;
                });
                html += `</div></div>`;
            });
            container.innerHTML = html;
            loadCartFromStorage();
        }

        // --- LÃ³gica de Carrito ---
        function getProductById(id) { return flatProducts.find(p => p.id === id) || null; }

        function triggerPopAnim(elementId) {
            const el = document.getElementById(elementId);
            if(el) {
                el.classList.remove('pop-anim');
                void el.offsetWidth; // Reflow
                el.classList.add('pop-anim');
            }
        }

        function syncProductUI(productId) {
            const qty = cart[productId] || 0;
            const btn = document.getElementById(`add-btn-${productId}`);
            const ctrls = document.getElementById(`ctrls-${productId}`);
            const qtyLabel = document.getElementById(`qty-${productId}`);
            
            if(qtyLabel) {
                qtyLabel.innerText = qty;
                triggerPopAnim(`qty-${productId}`);
            }
            if(btn && ctrls) {
                if(qty > 0) { btn.classList.add('hidden'); ctrls.classList.remove('hidden'); ctrls.classList.add('flex'); } 
                else { btn.classList.remove('hidden'); ctrls.classList.add('hidden'); ctrls.classList.remove('flex'); }
            }
        }

        function addComboToCart(qty, tier) {
            if (flatProducts.length === 0) return;
            clearCartSilent();
            let shuffled = [...flatProducts].sort(() => 0.5 - Math.random());
            let numUnique = Math.min(flatProducts.length, Math.ceil(qty / 2)); 
            if (numUnique === 0) return;

            let selected = shuffled.slice(0, numUnique);
            let distribution = {};
            selected.forEach(p => distribution[p.id] = 1);
            let remaining = qty - numUnique;

            while(remaining > 0) {
                distribution[selected[Math.floor(Math.random() * selected.length)].id]++;
                remaining--;
            }

            for (let id in distribution) {
                cart[id] = distribution[id];
                syncProductUI(id);
            }

            saveCartToStorage();
            calculateTotals();
            openCartModal(); 
            haptic('success');
            confetti({ particleCount: 100, spread: 70, origin: { y: 0.6 } });
            showIOSNotification(`Surtido x${qty} listo. Â¡EdÃ­talo!`, 'success');
        }

        function updateCart(productId, change) {
            if (!cart[productId]) cart[productId] = 0;
            cart[productId] += change;
            if (cart[productId] < 0) cart[productId] = 0;
            
            syncProductUI(productId);
            saveCartToStorage();
            
            if (change > 0) haptic('light');
            else haptic('heavy');
            
            calculateTotals();
            if(!document.getElementById('cart-modal').classList.contains('hidden')) {
                renderCartModalItems(); 
            }
        }

        function removeProduct(productId) {
            if(cart[productId]) {
                cart[productId] = 0;
                syncProductUI(productId);
                saveCartToStorage();
                calculateTotals();
                renderCartModalItems();
                haptic('heavy');
            }
        }

        function clearCartSilent() {
            for (let id in cart) { cart[id] = 0; syncProductUI(id); }
            cart = {};
            localStorage.removeItem('miniperfumes_cart_cbo');
        }

        function clearCart() {
            clearCartSilent();
            calculateTotals();
            renderCartModalItems();
            closeCartModal();
            haptic('success');
            showIOSNotification('Carrito vaciado', 'error');
        }

        function saveCartToStorage() { localStorage.setItem('miniperfumes_cart_cbo', JSON.stringify(cart)); }

        function loadCartFromStorage() {
            const saved = localStorage.getItem('miniperfumes_cart_cbo');
            if (saved) {
                cart = JSON.parse(saved);
                for (let id in cart) syncProductUI(id);
                calculateTotals();
            }
        }

        function updateProgressBar(totalQty) {
            const bar = document.getElementById('progress-bar');
            const msg = document.getElementById('progress-msg');
            const title = document.getElementById('progress-title');
            const price = document.getElementById('progress-price');

            if (totalQty < 20) {
                let p = (totalQty / 20) * 100;
                bar.style.width = `${p}%`; bar.className = "h-full rounded-full progress-bar-fill bg-textLight";
                msg.innerHTML = `Agrega <strong>${20 - totalQty} uds mÃ¡s</strong> para alcanzar el mÃ­nimo y desbloquear precio de $6.00.`;
                title.innerText = "Iniciando"; price.innerText = "---";
            } else if (totalQty >= 20 && totalQty < 50) {
                let p = ((totalQty - 20) / 30) * 100;
                bar.style.width = `${p}%`; bar.className = "h-full rounded-full progress-bar-fill bg-iosBlue";
                msg.innerHTML = `Â¡Nivel Emprendedor! Agrega <strong class="text-iosBlue">${50 - totalQty} uds mÃ¡s</strong> para bajar a $4.50 c/u.`;
                title.innerText = "Emprendedor"; price.innerText = "$6.00 c/u";
            } else if (totalQty >= 50 && totalQty < 100) {
                let p = ((totalQty - 50) / 50) * 100;
                bar.style.width = `${p}%`; bar.className = "h-full rounded-full progress-bar-fill bg-iosOrange";
                msg.innerHTML = `Â¡Nivel Negocio! Agrega <strong class="text-iosOrange">${100 - totalQty} uds mÃ¡s</strong> para bajar a $3.50 c/u.`;
                title.innerText = "Negocio"; price.innerText = "$4.50 c/u";
            } else {
                bar.style.width = '100%'; bar.className = "h-full rounded-full progress-bar-fill bg-iosGreen";
                msg.innerHTML = `Â¡Felicidades! Has alcanzado el <strong class="text-iosGreen">Nivel Mayorista Top</strong>.`;
                title.innerText = "Mayorista"; price.innerText = "$3.50 c/u";
            }
        }

        function renderCartSuggestions() {
            const container = document.getElementById('cart-suggestions-container');
            const list = document.getElementById('cart-suggestions-list');
            let totalQty = Object.values(cart).reduce((a, b) => a + b, 0);
            
            if(totalQty === 0 || flatProducts.length < 3) { container.classList.add('hidden'); return; }

            let available = flatProducts.filter(p => !cart[p.id] || cart[p.id] === 0);
            let suggestions = available.sort(() => 0.5 - Math.random()).slice(0, 3);

            if(suggestions.length > 0) {
                let html = '';
                suggestions.forEach(prod => {
                    html += `
                    <div class="min-w-[100px] bg-iosCard border border-gray-100 p-2 rounded-2xl shadow-sm snap-center flex flex-col items-center text-center">
                        <img src="${prod.img}" class="w-12 h-12 object-cover rounded-xl mb-1 bg-[#F2F2F7]">
                        <p class="text-[9px] font-semibold text-textMain leading-tight line-clamp-2 w-full mb-1 h-[24px]">${prod.name}</p>
                        <button onclick="updateCart('${prod.id}', 1); renderCartSuggestions();" class="w-full bg-[#F2F2F7] text-iosBlue text-[10px] font-bold py-1.5 rounded-lg active:scale-95 transition-transform">
                            AÃ±adir
                        </button>
                    </div>`;
                });
                list.innerHTML = html;
                container.classList.remove('hidden');
            } else { container.classList.add('hidden'); }
        }

        function renderCartModalItems() {
            const container = document.getElementById('cart-items-container');
            let totalQty = Object.values(cart).reduce((a, b) => a + b, 0);
            
            if (totalQty === 0) {
                container.innerHTML = `<div class="text-center text-textLight mt-12"><i class="fas fa-shopping-bag text-5xl mb-3 opacity-50"></i><p class="text-sm font-medium">Tu pedido estÃ¡ vacÃ­o</p></div>`;
                document.getElementById('cart-suggestions-container').classList.add('hidden');
                return;
            }

            let html = '';
            for (let id in cart) {
                if (cart[id] > 0) {
                    const prod = getProductById(id);
                    if(prod) {
                        html += `
                        <div class="flex items-center gap-3 bg-iosCard p-2 rounded-2xl mb-2">
                            <img src="${prod.img}" class="w-12 h-12 object-cover rounded-xl bg-[#F2F2F7]">
                            <div class="flex-1">
                                <p class="text-[13px] font-semibold text-textMain leading-tight mb-0.5">${prod.name}</p>
                                <p class="text-[10px] text-textLight">Cod: #${prod.id}</p>
                            </div>
                            <div class="flex flex-col items-end gap-1">
                                <div class="flex items-center gap-2 bg-[#F2F2F7] rounded-lg p-1">
                                    <button onclick="updateCart('${prod.id}', -1)" class="w-6 h-6 flex items-center justify-center text-textMain bg-white rounded shadow-sm active:scale-95"><i class="fas fa-minus text-[8px]"></i></button>
                                    <span class="text-xs font-bold w-4 text-center text-textMain">${cart[id]}</span>
                                    <button onclick="updateCart('${prod.id}', 1)" class="w-6 h-6 flex items-center justify-center text-textMain bg-white rounded shadow-sm active:scale-95"><i class="fas fa-plus text-[8px]"></i></button>
                                </div>
                            </div>
                        </div>`;
                    }
                }
            }
            container.innerHTML = html;
            renderCartSuggestions();
        }

        function setPaymentMethod(method) { 
            paymentMethod = method; 
            document.getElementById(`radio-${method}`).checked = true;
            haptic('light');
            calculateTotals(); 
        }

        let confettiFired = false;
        function calculateTotals() {
            let totalQty = Object.values(cart).reduce((a, b) => a + b, 0);
            let currentPrice = (totalQty >= 100) ? PRICES.top : ((totalQty >= 50) ? PRICES.mid : PRICES.base);

            if (totalQty >= 100 && !confettiFired) {
                confetti({ particleCount: 150, spread: 70, origin: { y: 0.6 }, colors: ['#1C1C1E', '#007AFF', '#34C759'] });
                confettiFired = true;
            } else if (totalQty < 100) confettiFired = false;

            updateProgressBar(totalQty);

            // Pop Animation on cart numbers
            const oldQty = document.getElementById('sticky-qty').innerText;
            if(oldQty != totalQty && totalQty > 0) triggerPopAnim('sticky-qty');

            document.getElementById('sticky-qty').innerText = totalQty;
            const stickyCart = document.getElementById('sticky-cart');
            if (totalQty > 0) stickyCart.classList.remove('translate-y-32');
            else stickyCart.classList.add('translate-y-32');

            const subtotal = totalQty * currentPrice;
            let discount = 0;
            const discountRow = document.getElementById('cart-discount-row');

            if (paymentMethod === 'zelle' && totalQty >= 20) {
                discount = subtotal * 0.05; 
                if(discountRow) {
                    discountRow.classList.remove('hidden');
                    document.getElementById('cart-modal-discount').innerText = `-$${discount.toFixed(2)}`;
                }
            } else {
                if(discountRow) discountRow.classList.add('hidden');
            }

            const totalFinal = subtotal - discount;

            if(document.getElementById('cart-modal-qty')) document.getElementById('cart-modal-qty').innerText = totalQty;
            if(document.getElementById('cart-modal-subtotal')) document.getElementById('cart-modal-subtotal').innerText = `$${subtotal.toFixed(2)}`;
            if(document.getElementById('cart-modal-total')) document.getElementById('cart-modal-total').innerText = `$${totalFinal.toFixed(2)}`;
            document.getElementById('sticky-total').innerText = `$${totalFinal.toFixed(2)}`;

            const btnModal = document.getElementById('cart-modal-btn');
            if(btnModal) {
                if (totalQty >= 20) {
                    btnModal.disabled = false;
                    btnModal.innerHTML = `Confirmar Pedido`;
                } else {
                    btnModal.disabled = true;
                    if(totalQty > 0) btnModal.innerHTML = `Faltan ${20 - totalQty} uds`;
                    else btnModal.innerHTML = `AÃ±ade productos`;
                }
            }
        }

        function sendWhatsAppOrder() {
            haptic('success');
            let totalQty = Object.values(cart).reduce((a, b) => a + b, 0);
            if (totalQty < 20) return;

            let currentPrice = totalQty >= 100 ? PRICES.top : (totalQty >= 50 ? PRICES.mid : PRICES.base);
            let subtotal = totalQty * currentPrice;
            let discount = (paymentMethod === 'zelle') ? (subtotal * 0.05) : 0;
            let total = subtotal - discount;
            let payText = (paymentMethod === 'zelle') ? "Zelle / USDT (Dcto Aplicado âœ…)" : "Pago MÃ³vil / Efectivo";

            let orderDetails = "";
            for (let id in cart) {
                if (cart[id] > 0) {
                    const prod = getProductById(id);
                    if (prod) orderDetails += `- ${cart[id]}x [${prod.id}] ${prod.name} (${prod.cap})%0A`;
                }
            }

            const text = `Hola equipo CBO! ðŸš€%0A%0AEstoy listo(a) para mi importaciÃ³n.%0A%0AðŸ“¦ *MI LISTA:*%0A${orderDetails}%0AðŸ“Š *RESUMEN:*%0A- Total Piezas: ${totalQty}%0A- MÃ©todo: ${payText}%0A- Total a Pagar: *$${total.toFixed(2)}*%0A%0AQuiero proceder con el pago.`;
            window.open(`https://wa.me/584141087079?text=${text}`, '_blank');
        }

        // --- Asistente Tour ---
        const naviEl = document.getElementById('tour-navi');
        const naviSpeech = document.getElementById('tour-speech');

        async function startTour() {
            closeCartModal(); 
            window.scrollTo({top: 0, behavior: 'smooth'});
            naviEl.classList.remove('hidden');
            
            await naviMoveToAndSpeak('tour-step-1', "El menÃº rÃ¡pido. Toca aquÃ­ para pedir combos directos o usar el Bot.");
            
            document.getElementById('catalog-zone').classList.remove('hidden'); 
            window.scrollTo({top: document.getElementById('searchInput').offsetTop - 120, behavior: 'smooth'});
            await naviMoveToAndSpeak('searchInput', "Usa la barra inteligente para buscar aromas especÃ­ficos.");
            
            if(Object.keys(cart).length === 0 && flatProducts.length > 0) { updateCart(flatProducts[0].id, 1); }
            
            await naviMoveToAndSpeak('tour-step-3', "AquÃ­ verÃ¡s tu pedido actualizado en tiempo real.");
            
            naviSpeech.innerText = "Â¡Listo! Ya puedes empezar.";
            setTimeout(() => {
                naviEl.classList.add('opacity-0');
                setTimeout(() => {
                    naviEl.classList.add('hidden');
                    naviEl.classList.remove('opacity-0');
                    document.querySelectorAll('.tour-highlight').forEach(el => el.classList.remove('tour-highlight', 'relative', 'z-100'));
                }, 700);
            }, 3000);
        }

        function naviMoveToAndSpeak(targetId, text) {
            return new Promise(resolve => {
                const target = document.getElementById(targetId);
                if(!target) { resolve(); return; }

                document.querySelectorAll('.tour-highlight').forEach(el => el.classList.remove('tour-highlight'));
                target.classList.add('tour-highlight');

                const rect = target.getBoundingClientRect();
                naviEl.style.top = `${rect.bottom + 60}px`;
                naviSpeech.innerText = text;
                
                naviSpeech.classList.remove('pop-anim');
                void naviSpeech.offsetWidth; 
                naviSpeech.classList.add('pop-anim');

                setTimeout(() => { resolve(); }, 3500);
            });
        }

        window.onload = loadCatalog;
    </script>
</body>
</html>
